# PDF Editor - 要件定義書

## 1. プロジェクト概要

### 1.1 目的
Windows/Mac両対応のWebベースPDF編集ツールを開発する。

### 1.2 ターゲットユーザー
- プレゼン資料やドキュメントのPDFを編集したいユーザー
- 複数のPDFや画像を1つのPDFに結合したいユーザー

---

## 2. 機能要件

### 2.1 PDFの読み込み・表示

| ID | 要件 | 優先度 |
|----|------|--------|
| F-001 | 既存のPDFファイルを読み込める | 必須 |
| F-002 | 左側サイドバーに全ページのサムネイルプレビューを表示 | 必須 |
| F-003 | 右側メインエリアに選択中ページの内容を表示 | 必須 |
| F-004 | サムネイルクリックでメインビューのページを切り替え | 必須 |

### 2.2 ページ挿入

| ID | 要件 | 優先度 |
|----|------|--------|
| F-005 | サイドバーへのドラッグ＆ドロップでPDFを挿入できる | 必須 |
| F-006 | サイドバーへのドラッグ＆ドロップでPNG画像を挿入できる | 必須 |
| F-007 | サイドバーへのドラッグ＆ドロップでJPEG画像を挿入できる | 必須 |
| F-008 | 挿入時、元PDFの幅・高さに合わせてリサイズする | 必須 |
| F-009 | 挿入位置をドロップ位置で指定できる | 必須 |
| F-016 | コピーしたページを貼り付け（Paste）で挿入できる (`Ctrl+V`) | 任意（未実装） |

### 2.3 ページ削除

| ID | 要件 | 優先度 |
|----|------|--------|
| F-010 | 選択中のページをキーボードショートカットで削除できる | 必須 |
| F-011 | Windows: `Ctrl + D` で削除 | 必須 |
| F-012 | Mac: `Cmd + D` で削除 | 必須 |
| F-013 | 削除前に確認ダイアログを表示する | 任意 |

### 2.4 ページ操作（追加機能）

| ID | 要件 | 優先度 |
|----|------|--------|
| F-014 | サムネイルをドラッグしてページの順序を変更できる | 必須 |
| F-015 | ページを複製できる（コンテキストメニュー/ショートカット `Ctrl+C` -> `Ctrl+V`） | 必須 |
| F-034 | 複数のPDFファイルを1つに結合できる（「PDFを追加」機能） | 必須 |
| F-035 | 複数PDFを一度に選択して追加できる | 必須 |
| F-026 | ページを時計回りに90度回転できる | 必須 |
| F-027 | 全ページを一括削除（クリア）できる | 必須 |

### 2.5 出力
(中略...)

### 2.7 バイナリ分割（メール送信用）
(中略...)

### 2.8 注釈・編集

| ID | 要件 | 優先度 |
|----|------|--------|
| F-028 | ページ上にテキストを追加できる（色・サイズ選択可） | 必須 |
| F-029 | 追加したテキストをドラッグで位置調整できる | 必須 |
| F-029a | 追加したテキストをリサイズハンドルでサイズ変更できる | 必須 |
| F-030 | ページ上にマーカー（ハイライト）を引ける | 必須 |
| F-031 | 以下の操作をUndo（取り消し）できる：ページ削除/移動/回転/クリア/注釈追加 | 必須 |
| F-032 | 画像追加の操作をUndoできる | 必須 |
| F-033 | 注釈（テキスト/ハイライト）をコピー＆ペーストできる (`Ctrl+C`, `Ctrl+V`) | 必須 |

### 2.9 複数ページ選択

| ID | 要件 | 優先度 |
|----|------|--------|
| F-036 | Ctrl/Cmd+クリックで複数ページを選択できる | 必須 |
| F-037 | Shift+クリックで範囲選択できる | 必須 |
| F-038 | Ctrl/Cmd+A で全ページを選択できる | 必須 |
| F-039 | 選択した複数ページを一括で削除/回転/複製できる | 必須 |

### 2.10 ズーム機能

| ID | 要件 | 優先度 |
|----|------|--------|
| F-040 | メインビューを拡大/縮小できる（25%〜400%） | 必須 |
| F-041 | Ctrl/Cmd + +/- でズームイン/アウトできる | 必須 |
| F-042 | Ctrl/Cmd + 0 でズームをリセットできる | 必須 |
| F-043 | Ctrl/Cmd + マウスホイールでズームできる | 必須 |
| F-044 | ズーム時にスペース+ドラッグでパンできる | 必須 |

### 2.11 コンテキストメニュー

| ID | 要件 | 優先度 |
|----|------|--------|
| F-045 | サイドバーのページを右クリックでコンテキストメニューを表示できる | 必須 |
| F-046 | メインビューの注釈を右クリックでコンテキストメニューを表示できる | 必須 |

### 2.12 Undo/Redo

| ID | 要件 | 優先度 |
|----|------|--------|
| F-047 | Ctrl/Cmd + Z でUndoできる | 必須 |
| F-048 | Ctrl/Cmd + Y または Ctrl/Cmd + Shift + Z でRedoできる | 必須 |
| F-049 | 一括操作（複数ページ削除/回転/複製）をUndoできる | 必須 |

### 2.13 セッション保存

| ID | 要件 | 優先度 |
|----|------|--------|
| F-050 | 編集状態を自動的にローカルストレージに保存する | 必須 |
| F-051 | アプリ再起動時に前回の状態を復元できる | 必須 |

### 2.14 ヘルプ機能

| ID | 要件 | 優先度 |
|----|------|--------|
| F-052 | ショートカット一覧をモーダルで表示できる | 必須 |

### 2.15 注釈の高度な操作

| ID | 要件 | 優先度 |
|----|------|--------|
| F-053 | 注釈をクリックで選択できる | 必須 |
| F-054 | 選択した注釈をDeleteキーで削除できる | 必須 |
| F-055 | テキスト注釈を回転ハンドルで回転できる | 必須 |
| F-056 | ハイライト注釈をリサイズできる | 必須 |
| F-057 | テキスト注釈をダブルクリックで編集できる | 必須 |

### 2.16 CMYK変換・印刷用出力

| ID | 要件 | 優先度 |
|----|------|--------|
| F-058 | RGB → CMYK 変換機能を提供する | 必須 |
| F-059 | CMYKモードでのPDF保存ができる | 必須 |
| F-060 | CMYKプレビュー（印刷イメージ確認）ができる | 必須 |
| F-061 | ガマット警告（色域外の色を視覚的に警告）が表示される | 任意（未実装） |
| F-062 | ICCプロファイルを指定してCMYK変換ができる | 任意（将来対応） |

---

## 3. 非機能要件

### 3.1 クロスプラットフォーム対応

| ID | 要件 |
|----|------|
| NF-001 | Windows（Chrome, Edge, Firefox）で動作する |
| NF-002 | Mac（Chrome, Safari, Firefox）で動作する |
| NF-003 | ブラウザのみで動作（サーバー不要） |

### 3.2 パフォーマンス

| ID | 要件 |
|----|------|
| NF-004 | 50ページ程度のPDFを編集できる |
| NF-005 | PDF読み込み中はローディング表示する |

### 3.3 ユーザビリティ

| ID | 要件 |
|----|------|
| NF-006 | モダンで直感的なUI |
| NF-007 | ダークモード対応 |
| NF-008 | レスポンシブデザイン |

---

## 4. 技術要件

### 4.1 開発言語・フレームワーク

| 項目 | 選定 | 理由 |
|------|------|------|
| 言語 | TypeScript | 型安全性、保守性向上 |
| ビルドツール | Vite | 高速なビルド、モダンな開発体験 |
| スタイリング | Vanilla CSS | 柔軟性、フレームワーク非依存 |

### 4.2 PDF処理ライブラリ

| ライブラリ | 用途 |
|------------|------|
| pdf-lib | PDFの編集（ページ追加・削除・並べ替え） |
| pdf.js (pdfjs-dist) | PDFのレンダリング（プレビュー表示） |

---

## 5. 制約事項

- サーバーサイド処理は行わない（全てクライアントサイドで完結）
- 暗号化されたPDFは対象外
- 非常に大きなPDF（100MB以上）はパフォーマンス保証外

---

## 6. 用語定義

| 用語 | 説明 |
|------|------|
| サイドバー | 画面左側のページサムネイル一覧エリア |
| メインビュー | 画面右側のページ詳細表示エリア |
| ページ | PDFの1ページ単位 |
